<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff" />
    <title>Document</title>
    <!-- <link rel="apple-touch-icon" sizes="192x192" href="./pwa-192x192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="./pwa-512x512.png"> -->

    <link rel="manifest" href="./manifest.webmanifest">

    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
    <script>
    // VConsole 默认会挂载到 `window.VConsole` 上
    var vConsole = new window.VConsole();
    </script>
</head>

<body>
    <h1>pwa</h1>
    <button id="install" >Install</button>
    <button onclick="console.log(1)">交互1</button>
    <script>
        let installPrompt = null;
        const installButton = document.querySelector("#install");

        window.addEventListener("beforeinstallprompt", (event) => {
            console.log(event)
            event.preventDefault();
            installPrompt = event;
            // installButton.removeAttribute("hidden");

        });
      
        installButton.addEventListener("click", async () => {
            console.log(installPrompt)
            if (!installPrompt) {
                return;
            }
            const result = await installPrompt.prompt();
            console.log(`Install prompt was: ${result.outcome}`);
            //方式一
            if(result.outcome == 'accepted'){
                console.log("成功");
            }else{
                console.log("安装失败");
            }
           //方式二
            installPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === "accepted") {
                    console.log("成功");
                } else {
                    console.log("安装失败");
                }
            });


            // disableInAppInstallPrompt();
            // function disableInAppInstallPrompt() {
            //     installPrompt = null;
            //     installButton.setAttribute("hidden", "");
            // }
        }) 
    </script>
</body>
</html>